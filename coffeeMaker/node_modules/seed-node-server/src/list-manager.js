const crypto = require('shardus-crypto-utils')

const ListManager = {}

ListManager.list = []

ListManager.signedList = { seedNodes: ListManager.list }

ListManager.init = function (config) {
  crypto(config.hashKey)
  this.publicKey = config.netAdmin.publicKey
  this.secretKey = config.netAdmin.secretKey
}

ListManager.setList = function (newList = []) {
  this.list = newList
  this.signedList = signList(this.list, this.publicKey, this.secretKey)
  if (process.env.NODE_ENV !== 'production') console.log('DBG', 'ListManager.list set to:', JSON.stringify(this.list))
}

function signList (list = [], publicKey, secretKey) {
  const signedList = {
    seedNodes: list
  }
  crypto.signObj(signedList, secretKey, publicKey)
  return signedList
}

module.exports = ListManager
